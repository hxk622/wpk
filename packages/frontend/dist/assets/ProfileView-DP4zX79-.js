import{_ as C,i as g,r as R,o as S,c as B,a as t,b as l,d as i,t as h,w as m,s as r,g as L,h as N,j as w}from"./index-DuysnCwA.js";import{u as j}from"./user-aMWrx1op.js";import{u as p}from"./user-CBVw-EAl.js";import"./axios-DCPBCOZw.js";import"./logger-BnKYzyre.js";const z={class:"profile"},A={class:"profile-container"},T={class:"profile-header"},$={class:"profile-avatar"},D={class:"profile-avatar-edit"},E={class:"profile-info"},I={class:"profile-name"},M={class:"profile-email"},q={class:"profile-form"},F={class:"profile-stats"},H="https://img.yzcdn.cn/vant/cat.jpeg",J={__name:"ProfileView",setup(K){const f=L(),_=j(),a=g({username:"",email:"",nickname:"",bio:"",avatar:""}),s=g({totalGames:0,winGames:0,winRate:0,totalProfit:0}),d=R(!1),V=()=>{f.back()},k=async()=>{try{const e=await p.getProfile();e&&e.user&&(a.username=e.user.username,a.email=e.user.email,a.nickname=e.user.nickname||"",a.bio=e.user.bio||"",a.avatar=e.user.avatar||"",e.user.stats&&(s.totalGames=e.user.stats.totalGames||0,s.winGames=e.user.stats.winGames||0,s.winRate=e.user.stats.winRate||0,s.totalProfit=e.user.stats.totalProfit||0))}catch(e){console.error("获取用户资料失败:",e),r("获取用户资料失败")}},y=async()=>{try{d.value=!0;const e=await p.updateProfile({nickname:a.nickname,bio:a.bio});e&&e.success?(r("资料更新成功"),_.updateUser(e.user)):r(e?.message||"资料更新失败")}catch(e){console.error("更新用户资料失败:",e),r("资料更新失败")}finally{d.value=!1}},x=()=>{p.logout(),_.logout(),f.push("/login"),r("退出登录成功")};return S(()=>{k()}),(e,o)=>{const P=i("van-nav-bar"),G=i("van-image"),U=i("van-icon"),u=i("van-field"),v=i("van-cell-group"),c=i("van-cell"),b=i("van-button");return N(),B("div",z,[t(P,{title:"个人资料","left-text":"返回","left-arrow":"",onClickLeft:V}),l("div",A,[l("div",T,[l("div",$,[t(G,{round:"",src:a.avatar||H,width:"80px",height:"80px"},null,8,["src"]),l("div",D,[t(U,{name:"plus",size:"18"})])]),l("div",E,[l("h3",I,h(a.username),1),l("p",M,h(a.email),1)])]),l("div",q,[t(v,{inset:""},{default:m(()=>[t(u,{modelValue:a.username,"onUpdate:modelValue":o[0]||(o[0]=n=>a.username=n),name:"username",label:"用户名",placeholder:"请输入用户名","left-icon":"contact",readonly:""},null,8,["modelValue"]),t(u,{modelValue:a.email,"onUpdate:modelValue":o[1]||(o[1]=n=>a.email=n),name:"email",label:"邮箱",placeholder:"请输入邮箱","left-icon":"mail-o",readonly:""},null,8,["modelValue"]),t(u,{modelValue:a.nickname,"onUpdate:modelValue":o[2]||(o[2]=n=>a.nickname=n),name:"nickname",label:"昵称",placeholder:"请输入昵称","left-icon":"label-o"},null,8,["modelValue"]),t(u,{modelValue:a.bio,"onUpdate:modelValue":o[3]||(o[3]=n=>a.bio=n),name:"bio",label:"个性签名",placeholder:"请输入个性签名","left-icon":"chat-o",type:"textarea",rows:"2",maxlength:"100"},null,8,["modelValue"])]),_:1}),l("div",F,[t(v,{inset:""},{default:m(()=>[t(c,{title:"游戏场次",value:s.totalGames},null,8,["value"]),t(c,{title:"获胜场次",value:s.winGames},null,8,["value"]),t(c,{title:"胜率",value:`${s.winRate}%`},null,8,["value"]),t(c,{title:"总盈利",value:`${s.totalProfit} 筹码`},null,8,["value"])]),_:1})]),t(b,{type:"primary",class:"profile-update-btn",loading:d.value,onClick:y},{default:m(()=>[...o[4]||(o[4]=[w(" 更新资料 ",-1)])]),_:1},8,["loading"]),t(b,{type:"default",class:"profile-logout-btn",onClick:x},{default:m(()=>[...o[5]||(o[5]=[w(" 退出登录 ",-1)])]),_:1})])])])}}},Z=C(J,[["__scopeId","data-v-58203c15"]]);export{Z as default};
