import{_ as h,i as y,r as g,c as k,b as n,a as t,w,d as m,g as P,h as C,j as f,s as a}from"./index-DuysnCwA.js";import{u as R}from"./user-CBVw-EAl.js";import{l as r}from"./logger-BnKYzyre.js";import"./axios-DCPBCOZw.js";const x={class:"register"},A={class:"register-container"},q={class:"register-form"},I={class:"register-login"},U={__name:"RegisterView",setup(z){const c=P(),e=y({username:"",email:"",password:"",confirmPassword:""}),u=g(!1),d=g(!1),p=g(!1),v=async()=>{try{if(r.info("开始注册尝试",{username:e.username,email:e.email}),!e.username.trim()){a("请输入用户名"),r.warn("注册验证失败：未输入用户名");return}if(e.username.length<6||e.username.length>20){a("用户名长度必须在6-20位之间"),r.warn("注册验证失败：用户名长度不符合要求",{username:e.username});return}if(!e.email.trim()){a("请输入邮箱"),r.warn("注册验证失败：未输入邮箱");return}if(!/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/.test(e.email)){a("邮箱格式不正确"),r.warn("注册验证失败：邮箱格式不正确",{email:e.email});return}if(!e.password.trim()){a("请输入密码"),r.warn("注册验证失败：未输入密码");return}if(e.password.length<6){a("密码长度不能少于6位"),r.warn("注册验证失败：密码长度不足");return}if(e.password!==e.confirmPassword){a("两次输入的密码不一致"),r.warn("注册验证失败：两次输入的密码不一致");return}p.value=!0,r.debug("注册验证通过，准备调用API");const o=await R.register({username:e.username,email:e.email,password:e.password});a("注册成功"),r.info("注册成功",{username:e.username,email:e.email}),setTimeout(()=>{c.push("/login")},1500)}catch(o){r.error("注册失败",{error:o,username:e.username,email:e.email}),o.message?a(o.message):o.response&&o.response.data&&o.response.data.message?a(o.response.data.message):a("注册失败，请稍后重试")}finally{p.value=!1,r.debug("注册流程结束")}};return(o,s)=>{const i=m("van-field"),_=m("van-cell-group"),V=m("van-button"),b=m("router-link");return C(),k("div",x,[n("div",A,[s[9]||(s[9]=n("div",{class:"register-header"},[n("h2",{class:"register-title"},"德州扑克"),n("p",{class:"register-subtitle"},"创建新账号")],-1)),n("div",q,[t(_,{inset:""},{default:w(()=>[t(i,{modelValue:e.username,"onUpdate:modelValue":s[0]||(s[0]=l=>e.username=l),name:"username",label:"用户名",placeholder:"请输入用户名（6-20位字符）","left-icon":"contact",rules:[{required:!0,message:"请输入用户名"}]},null,8,["modelValue"]),t(i,{modelValue:e.email,"onUpdate:modelValue":s[1]||(s[1]=l=>e.email=l),name:"email",label:"邮箱",placeholder:"请输入邮箱地址","left-icon":"mail-o",rules:[{required:!0,message:"请输入邮箱"},{type:"email",message:"邮箱格式不正确"}]},null,8,["modelValue"]),t(i,{modelValue:e.password,"onUpdate:modelValue":s[2]||(s[2]=l=>e.password=l),name:"password",label:"密码",type:"password",placeholder:"请输入密码（至少6位）","left-icon":"locked",rules:[{required:!0,message:"请输入密码"}],"show-password":u.value,"right-icon":"eye-o",onClickRightIcon:s[3]||(s[3]=l=>u.value=!u.value)},null,8,["modelValue","show-password"]),t(i,{modelValue:e.confirmPassword,"onUpdate:modelValue":s[4]||(s[4]=l=>e.confirmPassword=l),name:"confirmPassword",label:"确认密码",type:"password",placeholder:"请再次输入密码","left-icon":"locked",rules:[{required:!0,message:"请确认密码"}],"show-password":d.value,"right-icon":"eye-o",onClickRightIcon:s[5]||(s[5]=l=>d.value=!d.value)},null,8,["modelValue","show-password"])]),_:1}),t(V,{type:"primary",class:"register-btn",loading:p.value,onClick:v},{default:w(()=>[...s[6]||(s[6]=[f(" 注册 ",-1)])]),_:1},8,["loading"]),n("div",I,[s[8]||(s[8]=n("span",null,"已有账号？",-1)),t(b,{to:"/login"},{default:w(()=>[...s[7]||(s[7]=[f("立即登录",-1)])]),_:1})])])])])}}},$=h(U,[["__scopeId","data-v-6694b9b1"]]);export{$ as default};
